test_01_password_hashing (tests.test_auth_endpoints.AuthEndpointsTestCase.test_01_password_hashing)
Unit test for password hashing logic used by the auth service ... ERROR
test_02_signup_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_02_signup_success)
Integration test: Signup a new user ... 2026-02-25 13:35:20 [WARNING] [req_id:a2905b14-dbd9-463c-a24a-6f8ab5a757e1] Auth event: signup failed user_exists email=newuser@example.com ip=127.0.0.1
2026-02-25 13:35:20 [INFO] [req_id:a2905b14-dbd9-463c-a24a-6f8ab5a757e1] POST /api/auth/signup - Status: 400 - Latency: 0.0ms
FAIL
test_02_signup_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_02_signup_success)
Integration test: Signup a new user ... ERROR
test_03_signup_duplicate_fails (tests.test_auth_endpoints.AuthEndpointsTestCase.test_03_signup_duplicate_fails)
Integration test: Signup failure on duplicate email ... 2026-02-25 13:35:25 [WARNING] [req_id:4e196f44-2dcc-40f3-b4d0-b35b2ccd004a] Auth event: signup failed user_exists email=dup@example.com ip=127.0.0.1
2026-02-25 13:35:25 [INFO] [req_id:4e196f44-2dcc-40f3-b4d0-b35b2ccd004a] POST /api/auth/signup - Status: 400 - Latency: 1.69ms
2026-02-25 13:35:25 [WARNING] [req_id:35d42877-77f8-4f24-9879-198b192980a6] Auth event: signup failed user_exists email=dup@example.com ip=127.0.0.1
2026-02-25 13:35:25 [INFO] [req_id:35d42877-77f8-4f24-9879-198b192980a6] POST /api/auth/signup - Status: 400 - Latency: 0.93ms
ERROR
test_04_login_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_04_login_success)
Integration test: Login with correct credentials ... 2026-02-25 13:35:31 [ERROR] [req_id:0e40df22-55ee-4196-b2ad-58a3a8e84dcb] Exception on /api/auth/signup [POST]
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\app.py", line 240, in api_signup
    user_id = create_user(email, password)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\database.py", line 379, in create_user
    cursor.execute("INSERT INTO users (email, password_hash) VALUES (?, ?)", (email, hashed))
sqlite3.OperationalError: database is locked
2026-02-25 13:35:31 [INFO] [req_id:0e40df22-55ee-4196-b2ad-58a3a8e84dcb] POST /api/auth/signup - Status: 500 - Latency: 5566.6ms
2026-02-25 13:35:31 [WARNING] [req_id:4dd4f7eb-0504-4b7c-80bf-f79f441a5523] Auth event: login failed email=login@example.com ip=127.0.0.1
2026-02-25 13:35:31 [INFO] [req_id:4dd4f7eb-0504-4b7c-80bf-f79f441a5523] POST /api/auth/login - Status: 401 - Latency: 2.05ms
FAIL
test_04_login_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_04_login_success)
Integration test: Login with correct credentials ... ERROR
test_05_login_failure (tests.test_auth_endpoints.AuthEndpointsTestCase.test_05_login_failure)
Integration test: Login with invalid credentials ... 2026-02-25 13:35:42 [ERROR] [req_id:e9ed760a-18d2-460c-b01f-ccad901414a5] Exception on /api/auth/signup [POST]
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\app.py", line 240, in api_signup
    user_id = create_user(email, password)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\database.py", line 379, in create_user
    cursor.execute("INSERT INTO users (email, password_hash) VALUES (?, ?)", (email, hashed))
sqlite3.OperationalError: database is locked
2026-02-25 13:35:42 [INFO] [req_id:e9ed760a-18d2-460c-b01f-ccad901414a5] POST /api/auth/signup - Status: 500 - Latency: 5658.63ms
2026-02-25 13:35:42 [WARNING] [req_id:4e5c717c-ae96-4b57-bab2-3fa2e57d8625] Auth event: login failed email=fail@example.com ip=127.0.0.1
2026-02-25 13:35:42 [INFO] [req_id:4e5c717c-ae96-4b57-bab2-3fa2e57d8625] POST /api/auth/login - Status: 401 - Latency: 1.52ms
ERROR
test_06_rate_limiting (tests.test_auth_endpoints.AuthEndpointsTestCase.test_06_rate_limiting)
Integration test: Login rate limit triggers after 5 attempts ... 2026-02-25 13:35:48 [WARNING] [req_id:a06b834e-4bc2-4992-99fe-06e41f89a745] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:35:48 [INFO] [req_id:a06b834e-4bc2-4992-99fe-06e41f89a745] POST /api/auth/login - Status: 401 - Latency: 2.53ms
2026-02-25 13:35:48 [WARNING] [req_id:5aebb94c-0d7c-471a-9174-7b56859fe799] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:35:48 [INFO] [req_id:5aebb94c-0d7c-471a-9174-7b56859fe799] POST /api/auth/login - Status: 401 - Latency: 0.0ms
2026-02-25 13:35:48 [WARNING] [req_id:f01af177-7de0-4f7d-8d0b-b6f726cb0406] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:35:48 [INFO] [req_id:f01af177-7de0-4f7d-8d0b-b6f726cb0406] POST /api/auth/login - Status: 401 - Latency: 0.0ms
2026-02-25 13:35:48 [WARNING] [req_id:1eb485ba-bb21-4193-8f03-5d908df3fa31] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:35:48 [INFO] [req_id:1eb485ba-bb21-4193-8f03-5d908df3fa31] POST /api/auth/login - Status: 401 - Latency: 2.02ms
2026-02-25 13:35:48 [WARNING] [req_id:7f048c72-7f62-423f-b385-694b8bb164ce] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:35:48 [INFO] [req_id:7f048c72-7f62-423f-b385-694b8bb164ce] POST /api/auth/login - Status: 401 - Latency: 0.0ms
2026-02-25 13:35:48 [WARNING] [req_id:cc508cbe-5616-4b9a-91de-8e2e9ffa34be] Auth event: login rate limited ip=127.0.0.1
2026-02-25 13:35:48 [INFO] [req_id:cc508cbe-5616-4b9a-91de-8e2e9ffa34be] POST /api/auth/login - Status: 429 - Latency: 0.0ms
ERROR
test_07_me_and_logout (tests.test_auth_endpoints.AuthEndpointsTestCase.test_07_me_and_logout)
Integration test: /me and /logout endpoints ... 2026-02-25 13:35:53 [ERROR] [req_id:114747d6-2174-4db3-98a7-834e4cc885ff] Exception on /api/auth/signup [POST]
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask\app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\app.py", line 240, in api_signup
    user_id = create_user(email, password)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\dev\github\business\Forensic_CPA_AI\database.py", line 379, in create_user
    cursor.execute("INSERT INTO users (email, password_hash) VALUES (?, ?)", (email, hashed))
sqlite3.OperationalError: database is locked
2026-02-25 13:35:53 [INFO] [req_id:114747d6-2174-4db3-98a7-834e4cc885ff] POST /api/auth/signup - Status: 500 - Latency: 5623.9ms
2026-02-25 13:35:53 [INFO] [req_id:7c426bc5-d00e-407f-aa94-01a4c61e3ece] GET /api/auth/me - Status: 401 - Latency: 0.0ms
FAIL
test_07_me_and_logout (tests.test_auth_endpoints.AuthEndpointsTestCase.test_07_me_and_logout)
Integration test: /me and /logout endpoints ... ERROR

======================================================================
ERROR: test_01_password_hashing (tests.test_auth_endpoints.AuthEndpointsTestCase.test_01_password_hashing)
Unit test for password hashing logic used by the auth service
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.OperationalError: database is locked

======================================================================
ERROR: test_02_signup_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_02_signup_success)
Integration test: Signup a new user
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.OperationalError: database is locked

======================================================================
ERROR: test_03_signup_duplicate_fails (tests.test_auth_endpoints.AuthEndpointsTestCase.test_03_signup_duplicate_fails)
Integration test: Signup failure on duplicate email
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.IntegrityError: FOREIGN KEY constraint failed

======================================================================
ERROR: test_04_login_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_04_login_success)
Integration test: Login with correct credentials
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.OperationalError: database is locked

======================================================================
ERROR: test_05_login_failure (tests.test_auth_endpoints.AuthEndpointsTestCase.test_05_login_failure)
Integration test: Login with invalid credentials
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.OperationalError: database is locked

======================================================================
ERROR: test_06_rate_limiting (tests.test_auth_endpoints.AuthEndpointsTestCase.test_06_rate_limiting)
Integration test: Login rate limit triggers after 5 attempts
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.IntegrityError: FOREIGN KEY constraint failed

======================================================================
ERROR: test_07_me_and_logout (tests.test_auth_endpoints.AuthEndpointsTestCase.test_07_me_and_logout)
Integration test: /me and /logout endpoints
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 26, in tearDown
    cursor.execute("DELETE FROM users WHERE email != 'root@system.local'")
sqlite3.OperationalError: database is locked

======================================================================
FAIL: test_02_signup_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_02_signup_success)
Integration test: Signup a new user
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 43, in test_02_signup_success
    self.assertEqual(resp.status_code, 200)
AssertionError: 400 != 200

======================================================================
FAIL: test_04_login_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_04_login_success)
Integration test: Login with correct credentials
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 65, in test_04_login_success
    self.assertEqual(resp.status_code, 200)
AssertionError: 401 != 200

======================================================================
FAIL: test_07_me_and_logout (tests.test_auth_endpoints.AuthEndpointsTestCase.test_07_me_and_logout)
Integration test: /me and /logout endpoints
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 94, in test_07_me_and_logout
    self.assertEqual(me_resp.status_code, 200)
AssertionError: 401 != 200

----------------------------------------------------------------------
Ran 7 tests in 44.666s

FAILED (failures=3, errors=7)
