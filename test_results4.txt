test_01_password_hashing (tests.test_auth_endpoints.AuthEndpointsTestCase.test_01_password_hashing)
Unit test for password hashing logic used by the auth service ... ok
test_02_signup_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_02_signup_success)
Integration test: Signup a new user ... 2026-02-25 13:37:05 [WARNING] [req_id:ad33d207-978b-47dc-b28f-d41ba72d703d] Auth event: signup failed user_exists email=newuser@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:ad33d207-978b-47dc-b28f-d41ba72d703d] POST /api/auth/signup - Status: 400 - Latency: 2.08ms
FAIL
test_03_signup_duplicate_fails (tests.test_auth_endpoints.AuthEndpointsTestCase.test_03_signup_duplicate_fails)
Integration test: Signup failure on duplicate email ... 2026-02-25 13:37:05 [WARNING] [req_id:45262b12-58f3-42a4-966c-aeb729e0a4a0] Auth event: signup failed user_exists email=dup@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:45262b12-58f3-42a4-966c-aeb729e0a4a0] POST /api/auth/signup - Status: 400 - Latency: 1.99ms
2026-02-25 13:37:05 [WARNING] [req_id:0e847258-1559-460a-8962-aec14f8b5288] Auth event: signup failed user_exists email=dup@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:0e847258-1559-460a-8962-aec14f8b5288] POST /api/auth/signup - Status: 400 - Latency: 1.5ms
ok
test_04_login_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_04_login_success)
Integration test: Login with correct credentials ... 2026-02-25 13:37:05 [WARNING] [req_id:df62cfa1-146c-4e6e-ae2b-84ba967ace8c] Auth event: signup failed user_exists email=login_success@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:df62cfa1-146c-4e6e-ae2b-84ba967ace8c] POST /api/auth/signup - Status: 400 - Latency: 3.24ms
2026-02-25 13:37:05 [INFO] [req_id:756ddd69-7778-43a1-8e9b-1e8ceca8d4b7] Auth event: login success user_id=4 email=login_success@example.com ip=127.0.0.1
C:\dev\github\business\Forensic_CPA_AI\.venv\Lib\site-packages\flask_login\login_manager.py:488: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  expires = datetime.utcnow() + duration
2026-02-25 13:37:05 [INFO] [req_id:756ddd69-7778-43a1-8e9b-1e8ceca8d4b7] POST /api/auth/login - Status: 200 - Latency: 89.31ms
ok
test_05_login_failure (tests.test_auth_endpoints.AuthEndpointsTestCase.test_05_login_failure)
Integration test: Login with invalid credentials ... 2026-02-25 13:37:05 [WARNING] [req_id:24ed52b3-b3ca-4056-91e2-f97b39d2fa6b] Auth event: signup failed user_exists email=login_fail@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:24ed52b3-b3ca-4056-91e2-f97b39d2fa6b] POST /api/auth/signup - Status: 400 - Latency: 2.16ms
2026-02-25 13:37:05 [WARNING] [req_id:68e670d8-a548-439f-a89e-d4480bf7641b] Auth event: login failed email=login_fail@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:68e670d8-a548-439f-a89e-d4480bf7641b] POST /api/auth/login - Status: 401 - Latency: 88.75ms
ok
test_06_rate_limiting (tests.test_auth_endpoints.AuthEndpointsTestCase.test_06_rate_limiting)
Integration test: Login rate limit triggers after 5 attempts ... 2026-02-25 13:37:05 [WARNING] [req_id:9d5e4ed4-e601-4c5d-b132-9a59c36b956a] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:9d5e4ed4-e601-4c5d-b132-9a59c36b956a] POST /api/auth/login - Status: 401 - Latency: 2.04ms
2026-02-25 13:37:05 [WARNING] [req_id:336f1d82-88b7-423a-9f5f-e3b3f5352a91] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:336f1d82-88b7-423a-9f5f-e3b3f5352a91] POST /api/auth/login - Status: 401 - Latency: 2.0ms
2026-02-25 13:37:05 [WARNING] [req_id:f5d663c7-4337-4b14-a0de-d82421f251f4] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:f5d663c7-4337-4b14-a0de-d82421f251f4] POST /api/auth/login - Status: 401 - Latency: 1.0ms
2026-02-25 13:37:05 [WARNING] [req_id:6bf3f42f-9f21-4e49-918a-34e7cc3923be] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:6bf3f42f-9f21-4e49-918a-34e7cc3923be] POST /api/auth/login - Status: 401 - Latency: 1.5ms
2026-02-25 13:37:05 [WARNING] [req_id:f70e69fd-e759-4d14-a9d4-439f06ebf75c] Auth event: login failed email=nonexistent@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:f70e69fd-e759-4d14-a9d4-439f06ebf75c] POST /api/auth/login - Status: 401 - Latency: 1.52ms
2026-02-25 13:37:05 [WARNING] [req_id:3bd41631-3858-42ba-bd41-ef499936cc75] Auth event: login rate limited ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:3bd41631-3858-42ba-bd41-ef499936cc75] POST /api/auth/login - Status: 429 - Latency: 0.0ms
ok
test_07_me_and_logout (tests.test_auth_endpoints.AuthEndpointsTestCase.test_07_me_and_logout)
Integration test: /me and /logout endpoints ... 2026-02-25 13:37:05 [WARNING] [req_id:e4a7a453-2848-44a1-977c-f04602a26ebc] Auth event: signup failed user_exists email=me@example.com ip=127.0.0.1
2026-02-25 13:37:05 [INFO] [req_id:e4a7a453-2848-44a1-977c-f04602a26ebc] POST /api/auth/signup - Status: 400 - Latency: 1.5ms
2026-02-25 13:37:05 [INFO] [req_id:c6aace6b-d05a-4e9d-8cc5-c02ec1411a70] GET /api/auth/me - Status: 401 - Latency: 0.0ms
FAIL

======================================================================
FAIL: test_02_signup_success (tests.test_auth_endpoints.AuthEndpointsTestCase.test_02_signup_success)
Integration test: Signup a new user
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 35, in test_02_signup_success
    self.assertEqual(resp.status_code, 200)
AssertionError: 400 != 200

======================================================================
FAIL: test_07_me_and_logout (tests.test_auth_endpoints.AuthEndpointsTestCase.test_07_me_and_logout)
Integration test: /me and /logout endpoints
----------------------------------------------------------------------
Traceback (most recent call last):
  File "C:\dev\github\business\Forensic_CPA_AI\tests\test_auth_endpoints.py", line 88, in test_07_me_and_logout
    self.assertEqual(me_resp.status_code, 200)
AssertionError: 401 != 200

----------------------------------------------------------------------
Ran 7 tests in 0.507s

FAILED (failures=2)
